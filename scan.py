"""
Scan the NVD for entries matching installed python packages.  For any CVEs that are found,
search exploit-db.com for known exploits.
"""

from cvescanner import package
import argparse

parser = argparse.ArgumentParser(description="Scan installed python packages for entries in the NVD.")
parser.add_argument('year', metavar='YYYY', type=int, help='the NVD year to scan')
parser.add_argument('--quiet', help="supress verbose output", action="store_true")
parser.add_argument('--path', help="path to existing NVD XML file")
parser.add_argument('--local', help="only scan for packages in the virtualenv", action="store_true")
args = parser.parse_args()

package.scan(
    year=args.year,
    local=args.local,
    path=args.path or None,
    verbose=not args.quiet,
)
