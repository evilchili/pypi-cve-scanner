"""
    cvescan/exploitdb.py
        -- check exploitdb for exploits matching specific CVEs
"""
import requests

SEARCH_URL = "http://www.exploit-db.com/search"


def search(cve):
    m = cve.split('-', 1)
    res = requests.get(SEARCH_URL, params={
        'action': 'search',
        'filter_cve': m[1].strip()
    })

    if res.status_code != 200:
        print "Warning: Received %d response from %s" % res.status_code, res.url
    elif "No results" not in res.text:
        # WAT should probably parse the page and get the exploit links
        return res.url
    else:
        return None
